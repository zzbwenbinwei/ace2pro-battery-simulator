# 更新日志
## 1.5.0 魔改解容模块电流版更新日志
快捷使用教程：安装模块重启后，进入webui-数据界面
根据个人需要修改以下三个地方：
1、电压阈值：低于电压阈值会强制显示2%电量，提醒你要充电了。
2、最大模拟电量：根据自身电池容量填写即可。
3、强制解容电量：最小让电池解容的电量。
   注意 内核最大容量+强制解容电量 ＜ 电池容量 即可
   
主要更新：
1、阈值电压：电池低于阈值电压后，模拟容量会减少，该参数用于显示2%电后要及时充电，电池已达低电压。
1.1、现在电池电压低于阈值电压时，模拟容量不再强制清零，而是改成每秒减少10直到数值为1，电压上升后不进行此操作。
2、最大模拟电量限制：用于解决长时间涓流，模拟容量异常的问题。一般设为电池容量大小，可根据实际情况调整大小。
如：一块6100mah的电池，3.15v开始充电，4.53v满电，满电显示，再次用到接近3.15v时，看一下模拟容量还剩多少，比如剩500，那就可以把最大模拟电量的值设为6100-500=5600
当然如果还没到3.15v的时候模拟电量已经用完为0，根据实际情况适度增加最大模拟电量的数值
3、新增 强制解容电量：当内核电量大于4000mah，且 模拟电量小于内核电量+强制解容电量 时，使 模拟电量=内核电量+强制解容电量，以达到强制解容的效果。

温馨提示：
1、模块刷完系统不会自动关机，突然自动关机说明电池饿死了，低电压请自觉充电，出问题概不负责。
1.1、充电会显示真实电量，充电时显示100%，拔掉充电器后显示不是100%说明没充满电。
1.2、放电时显示模拟电量，目前显示的最低电量为2%，不会下降到1%及以下。
2、米系需要干掉30s关机提示。
3、由原版、电压版解容刷入魔改模块时，请先卸载原来模块后，删除data/local/tmp里面的文件，再刷入魔改解容模块。
4、出现max_dian读取数值为0时，可能是其它模块误删导致，请重刷解容模块，根据情况卸载冲突模块。

其它调整：
1、开机自减由默认80改为50，可自行到webui配置。
2、优化了模拟电量处理逻辑，增加了同步内核电量变化的机制。
3、修复webui界面有几率卡死问题

## 1.4 魔改解容模块电流版更新日志
1、兼容了米系，现在oppo一加真我小米红米都能使用解容模块
1.1 注意：米系需要干掉30s才能正常使用
2、加入webui，现在可以在webui修改模块配置
3、现在最低电量是2%，不会下降到1%及以下。
3.1、注意：电压阈值（默认3.15v）是当电池小于电压阈值时（如3.1v＜3.15v），电量会强制显示2%，不会自动关机。
3.2、再次提醒，过低电量电压请去充电，出问题概不负责。
4、开机30s后，点击服务重启，dian.log不会自减80了
4、优化了充电检测函数
5、优化了安装脚本，现在可以覆盖安装了
6、修复阈值电压的bug
7、如果模块出现问题且当前情况紧急不能重启，可以在webui一键停止所有服务还原电池状态

## 1.3.2 魔改解容模块电流版更新日志
1、增加了设置关机阈值电压和最高模拟电流的功能
2、优化了拔掉充电器后的跳电显示问题
3、优化了最大模拟容量的处理逻辑
4、整理了battery_config.sh配置文件
