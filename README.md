# 🔋 舟版解容模块

> 基于**凌空**原版模块开发，**WebUI由枯黄落叶提供**
> 专为一加/OPPO/真我/小米/红米等设备打造的电池解容模块

## 📖 目录
- 特性介绍
- 安装说明
- 配置指南
- webui-使用
- 高级功能
- 常见问题
- 更新日志
- 免责声明

## ✨ 特性介绍

### 核心功能
- **🔋 电池解容** - 解除系统电池容量限制，显示真实电量
- **⚡ 智能电流管理** - 优化充电/放电电流算法
- **🌡️ 电压阈值保护** - 低于设定电压强制显示2%提醒充电
- **📊 实时监控** - Web界面实时查看电池状态和模块配置

### 兼容性
| 品牌 | 支持状态 | 特殊要求 |
|------|----------|----------|
| 一加/OPPO/真我 | ✅ 完全支持 | 无 |
| 小米/红米 | ✅ 支持 | 需要禁用30秒关机提示 |
| 其他品牌 | ⚠️ 可能支持 | 需要测试 |

## 📦 安装说明

### 前提条件
- Android 12+ 系统
- 已安装 Magisk 20.0+ 或 KernelSU
- 已解锁 Bootloader

### 安装步骤
1. **下载模块**

   # 从 Releases 页面下载最新版 ZIP 文件
   wget [https://github.com/your-repo/releases/download/v1.5.3/BatteryMod-1.5.3.zip](https://github.com/zzbwenbinwei/ace2pro-battery-simulator/releases/download/v1.5.3/zzb-battery-simulator-1.5.3.zip)


2. **刷入模块**
   - 打开 Magisk/KernelSU 应用
   - 进入"模块"页面 → "安装" → 选择下载的ZIP文件
   - 重启设备

### 升级说明
- **1.5.2+**: 支持覆盖安装，自动保留配置
- **旧版本**: 建议先卸载旧版，删除 `/data/local/tmp/` 中的相关文件后再安装

## ⚙️ 配置指南

### 核心参数配置
通过 WebUI 或直接编辑配置文件设置以下参数：

| 参数 | 默认值 | 说明 | 建议值 |
|------|--------|------|--------|
| **电压阈值** | 3150mV | 低于此电压强制显示2% | 3100-3300mV |
| **最大模拟电量** | 电池容量 | 防止涓流异常 | 实际容量-500mAh |
| **强制解容电量** | 800mAh | 最小解容电量 | 400-1000mAh |
| **开机自减** | 50mAh | 开机电量调整 | 30-80mAh |

### 配置文件位置

# 主配置文件
/data/adb/modules/ace2pro-battery-simulator/common/battery_config.sh


## 🌐 WebUI 使用

> **WebUI由枯黄落叶开发提供**

模块内置 Web 管理界面，可通过root管理器访问

## 🔧 高级功能

### 电压阈值保护
当电池电压低于设定阈值时：
- 电量强制显示 2%（不会自动关机）
- 模拟容量逐步减少（每秒-10mAh）
- 提醒用户及时充电

### 智能解容算法

#### 解容条件：
内核电量 > 4000mAh 且满足模拟电量 < 内核电量 + 强制解容电量

#### 解容结果：
模拟电量 = 内核电量 + 强制解容电量

### 电量百分比优化

#### 1.5.2+ 版本优化
最终百分比 = max(内核百分比, 模拟百分比) + 2%

## ❓ 常见问题

### Q: 安装后电量显示异常？
**A:** 这是正常现象，模块使用模拟电量百分比作为显示的电量

### Q: 小米设备出现30秒关机提示？
**A:** 需要禁用小米的30s管家提醒
- 永久解决（需要其他模块配合）
- 使用"干掉30秒"相关模块

### Q: 如何完全卸载模块？
**A:** 完整卸载步骤：
1. Magisk/KernelSU 中禁用或删除模块
2. 删除残留文件：
   rm -f /data/local/tmp
3. 重启设备

## 📋 更新日志

### 🚀 Version 1.5.3 (舟版) - 最新
- **修复** 开机电量卡100%的问题
- **更新** WebUI界面，修复内核电量百分比超100%的问题
- **添加** GitHub更新链接，现在可以通过管理器更新

### 🔧 Version 1.5.2
- **优化** 覆盖安装可以保留原配置了
- **改进** 100%电更耐用了：现在内核百分比、模拟电量百分比的计算结果，会在原来的基础上加2
- **修复** 开机卡电量的bug
- **删除** 电量缓降机制，优化了防回滚逻辑
- **优化** 阈值电压的判断
- **优化** 内核信息、文件信息读取异常时的处理
- **优化** RM值为0时的处理

### ⚡ Version 1.5.0
- **新增** 阈值电压：电池低于阈值电压后，模拟容量会减少，该参数用于显示2%电后要及时充电
- **新增** 最大模拟电量限制：用于解决长时间涓流，模拟容量异常的问题
- **新增** 强制解容电量：当内核电量大于4000mah时强制解容
- **优化** 模拟电量处理逻辑，增加了同步内核电量变化的机制
- **改进** 开机自减由默认80改为50，可自行到webui配置
- **修复** webui界面有几率卡死问题

### 🌐 Version 1.4.0
- **扩展** 兼容了米系，现在oppo一加真我小米红米都能使用解容模块
- **新增** WebUI，可以在webui修改模块配置
- **设置** 现在最低电量是2%，不会下降到1%及以下
- **优化** 开机30s后，点击服务重启，dian.log不会自减80了
- **优化** 充电检测函数
- **优化** 安装脚本，现在可以覆盖安装了
- **修复** 阈值电压的bug
- **新增** 紧急情况一键停止所有服务还原电池状态

### 📊 Version 1.3.2
- **新增** 设置关机阈值电压和最高模拟电流的功能
- **优化** 拔掉充电器后的跳电显示问题
- **优化** 最大模拟容量的处理逻辑
- **整理** battery_config.sh配置文件

## ⚠️ 免责声明

### 重要警告
> **使用本模块可能存在风险，请谨慎操作！**

### 版权声明
- **魔改版维护**: 舟自白
- **WebUI开发者**: 枯黄落叶
- **原版模块作者**: 凌空

### 安全注意事项
1. **电压阈值保护**：当电池电压低于阈值（默认3.15v）时，电量会强制显示2%，不会自动关机
2. **低电压警告**：过低电量电压请及时充电，出问题概不负责
3. **充电显示**：充电时会显示真实电量，充电显示100%，拔掉后不是100%说明没充满
4. **电池保护**：模块不会导致系统自动关机，突然自动关机说明电池可能已"饿死"

### 使用建议
- 🔋 电量低于20%时及时充电
- ⚡ 使用原装充电设备
- 🌡️ 避免高温环境下使用
- 📊 定期检查电池健康状况

### 责任限制
使用者需自行承担一切风险，开发者对因使用本模块导致的任何设备损坏、数据丢失或其他问题不承担责任。

## 🤝 参与贡献

欢迎提交 Issue 和 Pull Request！

### 问题反馈格式
设备型号: 
Android版本: 
Magisk版本: 
问题描述: 
错误日志: 
复现步骤:

**⭐ 如果这个项目对您有帮助，请给个Star！**

*最后更新: 2025年11月 | 版本: 1.5.3*  

**🔔 注意**: 本模块仍在积极开发中，功能可能随时变更，请关注更新日志。

